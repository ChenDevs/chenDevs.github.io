import{i as l,a as g,w as ct,b as O,c as d,d as dt,$ as V,e as R,f as b,g as v,h as C,j as ut,E as lt,D as a,k,u as gt,l as N,o as I,m as p,n as pt,s as mt,p as _,q as ft}from"./maverick.js";const bt=navigator?.userAgent.toLowerCase(),vt=/iphone|ipad|ipod|ios|crios|fxios/i.test(bt),yt=/(iphone|ipod)/gi.test(navigator?.platform),Tt=!!window.chrome,M=!!window.safari||vt;function Et(){return!l(screen.orientation)&&g(screen.orientation.lock)&&g(screen.orientation.unlock)}function x(i){return i||(i=document.createElement("video")),i.canPlayType("application/vnd.apple.mpegurl").length>0}function D(i){return!!document.pictureInPictureEnabled&&!i.disablePictureInPicture}function H(i){return g(i.webkitSupportsPresentationMode)&&g(i.webkitSetPresentationMode)}async function St(){const i=document.createElement("video");return i.volume=.5,await ct(0),i.volume===.5}function wt(){return window?.MediaSource??window?.WebKitMediaSource}function kt(){return window?.SourceBuffer??window?.WebKitSourceBuffer}function q(){const i=wt();if(l(i))return!1;const t=i&&g(i.isTypeSupported)&&i.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),e=kt(),s=l(e)||!l(e.prototype)&&g(e.prototype.appendBuffer)&&g(e.prototype.remove);return!!t&&!!s}function L(i,t="preconnect"){const e=document.querySelector(`link[href="${i}"]`);if(!O(e))return!0;const s=document.createElement("link");return s.rel=t,s.href=i,s.crossOrigin="true",document.head.append(s),!0}const y={};function It(i){if(y[i])return y[i].promise;const t=dt(),e=document.querySelector(`script[src="${i}"]`);if(!O(e))return t.resolve(),t.promise;const s=document.createElement("script");return s.src=i,s.onload=()=>{t.resolve(),delete y[i]},s.onerror=()=>{t.reject(),delete y[i]},setTimeout(()=>document.head.append(s),0),t.promise}function U(i){return i==="use-credentials"?"include":d(i)?"same-origin":void 0}const _t=/\.(m4a|m4b|mp4a|mpga|mp2|mp2a|mp3|m2a|m3a|wav|weba|aac|oga|spx)($|\?)/i,Lt=new Set(["audio/mpeg","audio/ogg","audio/3gp","audio/mp4","audio/webm","audio/flac"]),jt=/\.(mp4|og[gv]|webm|mov|m4v)(#t=[,\d+]+)?($|\?)/i,$t=new Set(["video/mp4","video/webm","video/3gp","video/ogg","video/avi","video/mpeg"]),K=/\.(m3u8)($|\?)/i,F=new Set(["application/vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"]);function J({src:i,type:t}){return typeof i=="string"&&K.test(i)||F.has(t)}function Pt(i){return typeof window.MediaStream<"u"&&i instanceof window.MediaStream}const At=V('<audio preload="none" aria-hidden="true"></audio>'),Ot=At;class Vt{canPlay({src:t,type:e}){return d(t)?_t.test(t)||Lt.has(e)||t.startsWith("blob:")&&e==="audio/object":e==="audio/object"}mediaType(){return"audio"}async load(){return new(await Promise.resolve().then(function(){return te})).AudioProvider(this.Qf)}render(t){return(()=>{const e=R(Ot);return b(()=>v(e,"controls",t.controls())),b(()=>v(e,"crossorigin",t.crossorigin())),C(e,s=>void(this.Qf=s)),e})()}}const Rt=V('<video preload="none" aria-hidden="true"></video>'),Ct=Rt;class B{canPlay(t){return d(t.src)?jt.test(t.src)||$t.has(t.type)||t.src.startsWith("blob:")&&t.type==="video/object"||J(t)&&x():t.type==="video/object"}mediaType(){return"video"}async load(t){return new(await Promise.resolve().then(function(){return ae})).VideoProvider(this.Vb,t)}render(t){const e=ut(()=>t.poster()&&t.controls()?t.poster():null);return(()=>{const s=R(Ct);return b(()=>v(s,"controls",t.controls())),b(()=>v(s,"crossorigin",t.crossorigin())),b(()=>v(s,"poster",e())),C(s,r=>void(this.Vb=r)),s})()}}const X=class extends B{preconnect(){L("https://cdn.jsdelivr.net","preconnect")}canPlay({src:i,type:t}){return X.supported&&d(i)&&(K.test(i)||F.has(t))}async load(i){return new(await Promise.resolve().then(function(){return pe})).HLSProvider(this.Vb,i)}};let Y=X;Y.supported=q();const j=Symbol(0),W=Symbol(0),u=Symbol(0),f=Symbol(0),Q=Symbol(0),T=Symbol(0),m=Symbol(0),z=Symbol(0);function Nt(i,t){for(let e=0,s=t.length;e<s;e++)if(E(t[e],i))return t[e];return null}function E(i,t){return t>=i.startTime&&t<i.endTime}function Mt(i,t,e){const s=i.toArray().find(r=>r.kind==="chapters"&&r.mode==="showing");if(s!==t){if(!s){e(null);return}s.readyState==2?e(s):(e(null),s.addEventListener("load",()=>e(s),{once:!0}))}}var G,Z,tt;class $ extends lt{constructor(t){super(),this.id="",this.label="",this.language="",this.default=!1,this.hc=!1,this.dc=0,this.fc="disabled",this.ic={},this.gc=[],this.cc=[],this.ec=[],this[G]=0,this[Z]=null,this[tt]=null;for(const e of Object.keys(t))this[e]=t[e];this.type||(this.type="vtt"),t.content?import("./captions/prod.js").then(({parseText:e,VTTCue:s,VTTRegion:r})=>{t.type==="json"?this.jc(t.content,s,r):e(t.content,{type:t.type}).then(({cues:h,regions:n})=>{this.cc=h,this.gc=n,this.kc()})}):t.src||(this[u]=2)}static createId(t){return`id::${t.type}-${t.kind}-${t.src??t.label}`}get metadata(){return this.ic}get regions(){return this.gc}get cues(){return this.cc}get activeCues(){return this.ec}get readyState(){return this[u]}get mode(){return this.fc}set mode(t){this.setMode(t)}addCue(t,e){let s=0,r=this.cc.length;for(s=0;s<r&&!(t.endTime<=this.cc[s].startTime);s++);s===r?this.cc.push(t):this.cc.splice(s,0,t),e?.type!=="cuechange"&&this[m]?.track.addCue(t),this.dispatchEvent(new a("add-cue",{detail:t,trigger:e})),E(t,this.dc)&&this[f](this.dc,e)}removeCue(t,e){const s=this.cc.indexOf(t);if(s>=0){const r=this.ec.includes(t);this.cc.splice(s,1),this[m]?.track.removeCue(t),this.dispatchEvent(new a("remove-cue",{detail:t,trigger:e})),r&&this[f](this.dc,e)}}setMode(t,e){this.fc!==t&&(this.fc=t,t==="disabled"?(this.ec=[],this.lc()):this.readyState===2?this[f](this.dc,e):this.mc(),this.dispatchEvent(new a("mode-change",{detail:this,trigger:e})),this[T]?.())}[(G=u,Z=T,tt=m,f)](t,e){if(this.dc=t,this.mode==="disabled"||!this.cc.length)return;const s=[];for(let h=0,n=this.cc.length;h<n;h++){const c=this.cc[h];E(c,t)&&s.push(c)}let r=s.length!==this.ec.length;if(!r){for(let h=0;h<s.length;h++)if(!this.ec.includes(s[h])){r=!0;break}}this.ec=s,r&&this.lc(e)}[Q](){this.hc=!0,this.fc!=="disabled"&&this.mc()}async mc(){if(!(!this.hc||!this.src||this[u]>0)){this[u]=1,this.dispatchEvent(new a("load-start"));try{const{parseResponse:t,VTTCue:e,VTTRegion:s}=await import("./captions/prod.js"),r=this[W]?.(),h=fetch(this.src,{headers:this.type==="json"?{"Content-Type":"application/json"}:void 0,credentials:U(r)});if(this.type==="json")this.jc(await(await h).text(),e,s);else{const{errors:n,metadata:c,regions:o,cues:ot}=await t(h,{type:this.type,encoding:this.encoding});if(n[0]?.code===0)throw n[0];this.ic=c,this.gc=o,this.cc=ot}this.kc()}catch(t){this.nc(t)}}}kc(){if(this[u]=2,!this.src||this.type!=="vtt"){const e=this[m]?.track;if(e)for(const s of this.cc)e.addCue(s)}const t=new a("load");this[f](this.dc,t),this.dispatchEvent(t)}nc(t){this[u]=3,this.dispatchEvent(new a("error",{detail:t}))}jc(t,e,s){try{t=JSON.parse(t),t.regions&&(this.gc=t.regions.map(r=>Object.assign(new s,r))),t.cues&&(this.cc=t.cues.filter(r=>k(r.startTime)&&k(r.endTime)).map(r=>Object.assign(new e(0,0,""),r)))}catch(r){this.nc(r)}}lc(t){this.dispatchEvent(new a("cue-change",{trigger:t}))}}const xt=/captions|subtitles/;function Dt(i){return xt.test(i.kind)}function Ht(i,t=2){return Number(i.toFixed(t))}function P(i){return String(i).split(".")[1]?.length??0}function qt(i,t,e){return Math.max(i,Math.min(e,t))}function Ut(i){return i instanceof HTMLAudioElement}function Kt(i){return i instanceof HTMLVideoElement}function Ft(i){return Ut(i)||Kt(i)}const S=Symbol(0),et=Symbol(0),Jt=Symbol(0),w=Symbol(0),Bt=Symbol(0),Xt=Symbol(0),Yt=Symbol(0),Wt=Symbol(0),Qt=Symbol(0),it=Symbol(0),A=Symbol(0);function st(i){return i instanceof Error?i:Error(JSON.stringify(i))}class rt{constructor(t){this.Ra=t}I(){l(this.ui)&&this.vi()}J(){k(this.ui)&&window.cancelAnimationFrame(this.ui),this.ui=void 0}vi(){this.ui=window.requestAnimationFrame(()=>{l(this.ui)||(this.Ra(),this.vi())})}}class zt{constructor(t,e){this.k=t,this.mh=e,this.gg=gt(),this.Kh=!1,this.Nh=!1,this.Oh=!1,this.Lh=new rt(this.Rh.bind(this)),this.li=void 0,this.mi=void 0,this.Sh(),N(this.Th.bind(this)),I(this.Dh.bind(this))}get d(){return this.k.media}get sg(){return this.mh.delegate}Dh(){this.Lh.J(),this.gg.empty()}Rh(){const t=this.k.currentTime;this.mh.$store.currentTime()!==t&&this.Jh(t)}Sh(){this.Ih("loadstart",this.re),this.Ih("abort",this.Ph),this.Ih("emptied",this.Uh),this.Ih("error",this.te)}Vh(){this.Nh||(this.gg.add(this.Ih("loadeddata",this.Wh),this.Ih("loadedmetadata",this.Xh),this.Ih("canplay",this.De),this.Ih("canplaythrough",this.Yh),this.Ih("durationchange",this.Zh),this.Ih("play",this._h),this.Ih("progress",this.$h),this.Ih("stalled",this.ai),this.Ih("suspend",this.bi)),this.Nh=!0)}ci(){this.Oh||(this.gg.add(this.Ih("pause",this.di),this.Ih("playing",this.ei),this.Ih("ratechange",this.fi),this.Ih("seeked",this.gi),this.Ih("seeking",this.hi),this.Ih("ended",this.ii),this.Ih("volumechange",this.xf),this.Ih("waiting",this.ji)),this.Oh=!0)}Ih(t,e){return p(this.d,t,e.bind(this))}ni(t){}Jh(t,e){this.sg.j("time-update",{detail:{currentTime:Math.min(t,this.mh.$store.seekableEnd()),played:this.d.played},trigger:e})}re(t){if(this.d.networkState===3){this.Ph(t);return}this.Vh(),this.sg.j("load-start",{trigger:t})}Ph(t){this.sg.j("abort",{trigger:t})}Uh(){this.sg.j("emptied",{trigger:event})}Wh(t){this.sg.j("loaded-data",{trigger:t})}Xh(t){this.Qh(),this.ci(),this.sg.j("volume-change",{detail:{volume:this.d.volume,muted:this.d.muted}}),this.sg.j("loaded-metadata",{trigger:t}),M&&J(this.mh.$store.source())&&this.sg.Ta(this.Mh(),t)}Mh(){return{duration:this.d.duration,buffered:this.d.buffered,seekable:this.d.seekable}}Qh(){const t=!Number.isFinite(this.d.duration);this.sg.j("stream-type-change",{detail:t?"live":"on-demand"})}_h(t){this.mh.$store.canPlay&&this.sg.j("play",{trigger:t})}di(t){this.d.readyState===1&&!this.Kh||(this.Kh=!1,this.Lh.J(),this.sg.j("pause",{trigger:t}))}De(t){this.sg.Ta(this.Mh(),t)}Yh(t){this.mh.$store.started()||this.sg.j("can-play-through",{trigger:t,detail:this.Mh()})}ei(t){this.Kh=!1,this.sg.j("playing",{trigger:t}),this.Lh.I()}ai(t){this.sg.j("stalled",{trigger:t}),this.d.readyState<3&&(this.Kh=!0,this.sg.j("waiting",{trigger:t}))}ji(t){this.d.readyState<3&&(this.Kh=!0,this.sg.j("waiting",{trigger:t}))}ii(t){this.Lh.J(),this.Jh(this.d.duration,t),this.sg.j("end",{trigger:t}),this.mh.$store.loop()?this.ki():this.sg.j("ended",{trigger:t})}Th(){this.mh.$store.paused()&&p(this.d,"timeupdate",this.He.bind(this))}He(t){this.Jh(this.d.currentTime,t)}Zh(t){this.Qh(),this.mh.$store.ended()&&this.Jh(this.d.duration,t),this.sg.j("duration-change",{detail:this.d.duration,trigger:t})}xf(t){this.sg.j("volume-change",{detail:{volume:this.d.volume,muted:this.d.muted},trigger:t})}gi(t){this.Jh(this.d.currentTime,t),this.sg.j("seeked",{detail:this.d.currentTime,trigger:t}),Math.trunc(this.d.currentTime)===Math.trunc(this.d.duration)&&P(this.d.duration)>P(this.d.currentTime)&&(this.Jh(this.d.duration,t),this.d.ended||this.mh.player.dispatchEvent(new a("media-play-request",{trigger:t})))}hi(t){this.sg.j("seeking",{detail:this.d.currentTime,trigger:t})}$h(t){this.sg.j("progress",{detail:{buffered:this.d.buffered,seekable:this.d.seekable},trigger:t})}ki(){pt(this.d.controls)&&(this.d.controls=!1),this.mh.player.dispatchEvent(new a("media-loop-request"))}bi(t){this.sg.j("suspend",{trigger:t})}fi(t){this.sg.j("rate-change",{detail:this.d.playbackRate,trigger:t})}te(t){const e=this.d.error;e&&this.sg.j("error",{detail:{message:e.message,code:e.code,mediaError:e},trigger:t})}}class Gt{constructor(t,e){this.k=t,this.mh=e,this.oi.onaddtrack=this.qi.bind(this),this.oi.onremovetrack=this.ri.bind(this),this.oi.onchange=this.si.bind(this),p(this.mh.audioTracks,"change",this.ti.bind(this))}get oi(){return this.k.media.audioTracks}qi(t){const e=t.track;if(e.label==="")return;const s={id:e.id+"",label:e.label,language:e.language,kind:e.kind,selected:!1};this.mh.audioTracks[S](s,t),e.enabled&&(s.selected=!0)}ri(t){const e=this.mh.audioTracks.getById(t.track.id);e&&this.mh.audioTracks[et](e,t)}si(t){let e=this.pi();if(!e)return;const s=this.mh.audioTracks.getById(e.id);s&&this.mh.audioTracks[w](s,!0,t)}pi(){return Array.from(this.oi).find(t=>t.enabled)}ti(t){const{current:e}=t.detail;if(!e)return;const s=this.oi.getTrackById(e.id);if(s){const r=this.pi();r&&(r.enabled=!1),s.enabled=!0}}}class ht{constructor(t){this.d=t}setup(t){new zt(this,t),"audioTracks"in this.media&&new Gt(this,t)}get type(){return""}get media(){return this.d}get paused(){return this.d.paused}get muted(){return this.d.muted}set muted(t){this.d.muted=t}get volume(){return this.d.volume}set volume(t){this.d.volume=t}get currentTime(){return this.d.currentTime}set currentTime(t){this.d.currentTime=t}get playsinline(){return this.d.hasAttribute("playsinline")}set playsinline(t){mt(this.d,"playsinline",t)}get playbackRate(){return this.d.playbackRate}set playbackRate(t){this.d.playbackRate=t}async play(){return this.d.play()}async pause(){return this.d.pause()}async loadSource({src:t},e){this.d.preload=e,Pt(t)?this.d.srcObject=t:(this.d.srcObject=null,this.d.src=d(t)?t:window.URL.createObjectURL(t)),this.d.load()}}class Zt extends ht{constructor(){super(...arguments),this.$$PROVIDER_TYPE="AUDIO"}get type(){return"audio"}setup(t){super.setup(t),this.type==="audio"&&t.delegate.j("provider-setup",{detail:this})}get audio(){return this.d}}var te=Object.freeze({__proto__:null,AudioProvider:Zt});class ee{constructor(t,e){this.Vb=t,this.mh=e,t.textTracks.onaddtrack=this.$b.bind(this),I(this.Dh.bind(this))}$b(t){const e=t.track;if(!e||ie(this.Vb,e))return;const s=new $({id:e.id,kind:e.kind,label:e.label,language:e.language,type:"vtt"});s[m]={track:e},s[u]=2,s[z]=!0;let r=0;const h=n=>{if(e.cues)for(let c=r;c<e.cues.length;c++)s.addCue(e.cues[c],n),r++};h(t),e.oncuechange=h,this.mh.textTracks.add(s,t),s.setMode(e.mode,t)}Dh(){this.Vb.textTracks.onaddtrack=null;for(const t of this.mh.textTracks){const e=t[m]?.track;e?.oncuechange&&(e.oncuechange=null)}}}function ie(i,t){return Array.from(i.children).find(e=>e.track===t)}class se{constructor(t,e){this.Vb=t,this.d=e,this.$c=(s,r)=>{this.d.delegate.j("picture-in-picture-change",{detail:s,trigger:r})},p(this.Vb,"enterpictureinpicture",this.Bh.bind(this)),p(this.Vb,"leavepictureinpicture",this.Ch.bind(this))}get active(){return document.pictureInPictureElement===this.Vb}get supported(){return D(this.Vb)}async enter(){return this.Vb.requestPictureInPicture()}exit(){return document.exitPictureInPicture()}Bh(t){this.$c(!0,t)}Ch(t){this.$c(!1,t)}}class re{constructor(t,e){this.Vb=t,this.d=e,this.fc="inline",p(this.Vb,"webkitpresentationmodechanged",this.Hh.bind(this))}get Gh(){return H(this.Vb)}async Fh(t){this.fc!==t&&this.Vb.webkitSetPresentationMode(t)}Hh(){const t=this.fc;this.fc=this.Vb.webkitPresentationMode,this.d.player?.dispatchEvent(new a("video-presentation-change",{detail:this.fc,trigger:event})),["fullscreen","picture-in-picture"].forEach(e=>{(this.fc===e||t===e)&&this.d.delegate.j(`${e}-change`,{detail:this.fc===e,trigger:event})})}}class he{constructor(t){this.Eh=t}get active(){return this.Eh.fc==="fullscreen"}get supported(){return this.Eh.Gh}async enter(){this.Eh.Fh("fullscreen")}async exit(){this.Eh.Fh("inline")}}class ne{constructor(t){this.Eh=t}get active(){return this.Eh.fc==="picture-in-picture"}get supported(){return this.Eh.Gh}async enter(){this.Eh.Fh("picture-in-picture")}async exit(){this.Eh.Fh("inline")}}class nt extends ht{constructor(t,e){if(super(t),this.$$PROVIDER_TYPE="VIDEO",H(t)){const s=new re(t,e);this.fullscreen=new he(s),this.pictureInPicture=new ne(s)}else D(t)&&(this.pictureInPicture=new se(t,e))}get type(){return"video"}setup(t){super.setup(t),x(this.video)&&new ee(this.video,t),t.textRenderers[j](this.video),I(()=>{t.textRenderers[j](null)}),this.type==="video"&&t.delegate.j("provider-setup",{detail:this})}get video(){return this.d}}var ae=Object.freeze({__proto__:null,VideoProvider:nt});const oe=i=>ft(i);class ce{constructor(t){this.Vb=t,this.lh=null,this.nh=null,this.jh={},this.kh=new Set}get instance(){return this.lh}setup(t,e){this.mh=e;const s=_(e.$store.streamType).includes("live"),r=_(e.$store.streamType).includes("ll-");this.lh=new t({lowLatencyMode:r,backBufferLength:r?4:s?8:void 0,renderTextTracksNatively:!1,...this.jh});const h=this.oh.bind(this);for(const n of Object.values(t.Events))this.lh.on(n,h);this.lh.on(t.Events.ERROR,this.te.bind(this));for(const n of this.kh)n(this.lh);e.player.dispatchEvent(new a("hls-instance",{detail:this.lh})),this.lh.attachMedia(this.Vb),this.lh.on(t.Events.AUDIO_TRACK_SWITCHED,this.ph.bind(this)),this.lh.on(t.Events.LEVEL_SWITCHED,this.qh.bind(this)),this.lh.on(t.Events.LEVEL_LOADED,this.rh.bind(this)),this.lh.on(t.Events.NON_NATIVE_TEXT_TRACKS_FOUND,this.sh.bind(this)),this.lh.on(t.Events.CUES_PARSED,this.th.bind(this)),e.qualities[A]=this.uh.bind(this),p(e.qualities,"change",this.Nb.bind(this)),p(e.audioTracks,"change",this.vh.bind(this)),this.nh=N(this.wh.bind(this))}wh(){if(!this.mh.$store.live())return;const t=new rt(this.xh.bind(this));return t.I(),t.J.bind(t)}xh(){this.mh.$store.liveSyncPosition.set(this.lh?.liveSyncPosition??1/0)}oh(t,e){this.mh.player.dispatchEvent(new a(oe(t),{detail:e}))}sh(t,e){const s=new a(t,{detail:e});let r=-1;for(let h=0;h<e.tracks.length;h++){const n=e.tracks[h],c=n.subtitleTrack??n.closedCaptions,o=new $({id:`hls-${n.kind}${h}`,src:c?.url,label:n.label,language:c?.lang,kind:n.kind});o[u]=2,o[T]=()=>{o.mode==="showing"?(this.lh.subtitleTrack=h,r=h):r===h&&(this.lh.subtitleTrack=-1,r=-1)},n.default&&o.setMode("showing",s),this.mh.textTracks.add(o,s)}}th(t,e){const s=this.mh.textTracks.getById(`hls-${e.track}`);if(!s)return;const r=new a(t,{detail:e});for(const h of e.cues)h.positionAlign="auto",s.addCue(h,r)}ph(t,e){const s=this.mh.audioTracks[e.id];s&&this.mh.audioTracks[w](s,!0,new a(t,{detail:e}))}qh(t,e){const s=this.mh.qualities[e.level];s&&this.mh.qualities[w](s,!0,new a(t,{detail:e}))}rh(t,e){if(this.mh.$store.canPlay())return;const{type:s,live:r,totalduration:h}=e.details,n=new a(t,{detail:e});this.mh.delegate.j("stream-type-change",{detail:r?s==="EVENT"&&Number.isFinite(h)?"live:dvr":"live":"on-demand",trigger:n}),this.mh.delegate.j("duration-change",{detail:h,trigger:n});const c=this.lh.media;this.lh.currentLevel===-1&&this.mh.qualities[it](!0,n);for(const o of this.lh.audioTracks)this.mh.audioTracks[S]({id:o.id+"",label:o.name,language:o.lang||"",kind:"main"},n);for(const o of this.lh.levels)this.mh.qualities[S]({width:o.width,height:o.height,codec:o.codecSet,bitrate:o.bitrate},n);c.dispatchEvent(new a("canplay",{trigger:n}))}te(t,e){if(e.fatal)switch(e.type){case"networkError":this.lh?.startLoad();break;case"mediaError":this.lh?.recoverMediaError();break;default:this.lh?.destroy(),this.lh=null;break}}uh(){this.lh&&(this.lh.currentLevel=-1)}Nb(){const{qualities:t}=this.mh;!this.lh||t.auto||(this.lh[t.switch+"Level"]=t.selectedIndex,Tt&&(this.Vb.currentTime=this.Vb.currentTime))}vh(){const{audioTracks:t}=this.mh;this.lh&&this.lh.audioTrack!==t.selectedIndex&&(this.lh.audioTrack=t.selectedIndex)}ng(){this.mh&&(this.mh.qualities[A]=void 0),this.lh?.destroy(),this.lh=null,this.nh?.(),this.nh=null}}class de{constructor(t,e,s){this.yh=t,this.mh=e,this.Ra=s,this.zh()}async zh(){const t={onLoadStart:this.re.bind(this),onLoaded:this.Jf.bind(this),onLoadError:this.Ah.bind(this)};let e=await le(this.yh,t);if(l(e)&&!d(this.yh)&&(e=await ue(this.yh,t)),!e)return null;if(!e.isSupported()){const s="[vidstack]: `hls.js` is not supported in this environment";return this.mh.player.dispatchEvent(new a("hls-unsupported")),this.mh.delegate.j("error",{detail:{message:s,code:4}}),null}return e}re(){this.mh.player.dispatchEvent(new a("hls-lib-load-start"))}Jf(t){this.mh.player.dispatchEvent(new a("hls-lib-loaded",{detail:t})),this.Ra(t)}Ah(t){const e=st(t);this.mh.player.dispatchEvent(new a("hls-lib-load-error",{detail:e})),this.mh.delegate.j("error",{detail:{message:e.message,code:4}})}}async function ue(i,t={}){if(!l(i)){if(t.onLoadStart?.(),i.prototype&&i.prototype!==Function)return t.onLoaded?.(i),i;try{const e=(await i())?.default;if(e&&e.isSupported)t.onLoaded?.(e);else throw Error("");return e}catch(e){t.onLoadError?.(e)}}}async function le(i,t={}){if(d(i)){t.onLoadStart?.();try{if(await It(i),!g(window.Hls))throw Error("");const e=window.Hls;return t.onLoaded?.(e),e}catch(e){t.onLoadError?.(e)}}}const ge="https://cdn.jsdelivr.net";class at extends nt{constructor(){super(...arguments),this.$$PROVIDER_TYPE="HLS",this.ih=null,this.$d=new ce(this.video),this.hh=`${ge}/npm/hls.js@^1.0.0/dist/hls.min.js`}get ctor(){return this.ih}get instance(){return this.$d.instance}get type(){return"hls"}get canLiveSync(){return!0}get config(){return this.$d.jh}set config(t){this.$d.jh=t}get library(){return this.hh}set library(t){this.hh=t}preconnect(){d(this.hh)&&L(this.hh)}setup(t){super.setup(t),new de(this.hh,t,e=>{this.ih=e,this.$d.setup(e,t),t.delegate.j("provider-setup",{detail:this});const s=_(t.$store.source);s&&this.loadSource(s)})}async loadSource({src:t}){d(t)&&this.$d.instance?.loadSource(t)}onInstance(t){const e=this.$d.instance;return e&&t(e),this.$d.kh.add(t),()=>this.$d.kh.delete(t)}destroy(){this.$d.ng()}}at.supported=q();var pe=Object.freeze({__proto__:null,HLSProvider:at});export{Vt as A,Mt as B,P as C,St as D,A as E,Y as H,M as I,Bt as L,it as S,$ as T,B as V,S as a,et as b,Et as c,Wt as d,Jt as e,Xt as f,U as g,Yt as h,Ft as i,w as j,Qt as k,st as l,Q as m,f as n,Dt as o,L as p,m as q,j as r,z as s,W as t,T as u,yt as v,qt as w,Nt as x,E as y,Ht as z};
